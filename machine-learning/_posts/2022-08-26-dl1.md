---
layout: post
title:  Autoregressive Integrated Moving Average(ARIMA)
date:   2022-08-26 16:06:59 +0900
tag: [machinelearning]
---

1. 시계열 데이터의 구성
: 일정한 시차(Time lag)에 따라 수집
→ 일반적인 자료와 다르게 시간(변수) 사이에 상관 관계 존재
1) 시계열 = 체계적 성분(Trend + Seasonal + Cycle) + 불규칙 성분(Random fluctuation)
2) 정상 시계열과 비정상 시계열
→ 정상 시계열 : 평균, 분산이 시간에 따라 일정한 성질
→ 비정상 시계열 → 모델링이 어려우므로, 정상 시계열로 변환해서 사용
 
2. 시계열 데이터 분해
1) Additive Decomposition Vs Multiplicative Decomposition
 
 
-> 변동폭이 일정 : Additive,
-> 변동폭이 일정X → 로그 변환이 필요 : Multiplicative
2) 기본 분해 원리 : 고전적인 Seasonal Decomposition
⇒ 데이터의 추세(Trend) 파악 : 이동 평균(MA: Moving Average)
⇒ 계절 성분의 측정 : 전체 - 데이터의 추세 → 이동 평균
3) 관련 모델 : seasonal_decomposition, X11, SEATS, STL	

3. 시계열 예측 모델 : 과거의 예측 값을 이용하는 방식
1) AR (Auto Regressive model) → RNN과 유사함
: t 시점을 예측할 때, t에서 p만큼 떨어진 시점까지의 자기 자신의 값을 이용
-자기상관성을 시계열 모형으로 구성하였으며, 예측하고자 하는 특정 변수의 과거 관측값의 선형결합으로 해당 변수의 미래값을 예측하는 모형이다. 이전 자신의 관측값이 이후 자신의 관측값에 영향을 준다는 아이디어.
⇒ autocorrelation을 모델링
 
ex) AR(p=1) : 하나의 시간 간격 이전의 데이터만 현재 데이터를 예측하는데 사용.
 
2) MA(Moving Average model)
: t 시점을 예측할 때, t에서 p만큼 떨어진 시점까지의 오차 값을 이용
⇒ 예측 오차에 의한 영향을 이용해 모델링
 
3) ARMA(AutoRegressive and Moving Average model)
⇒ 오차 + Autocorrelation모두 고려
 
4) ARIMA : ARMA + 과거 데이터의 추세
(1) ARIMA
Autoregressive Integrated Moving Average의 뜻으로 AR+MA모형이다.
ARIMA(p,d,q) 모형은 d차 차분한 데이터에 AR(p) 모형과 MA(q) 모형을 합친 모형
⇒ 오차 + Autocorrelation + Trend까지 고려 (Seasonal Variatio n 고려 X)
 
: ARMA 모델 + d번 differnecing
: 구해야 하는 변수 → p(자기 상관), d(차분 계수), q(잔차의 정상성 계수)
⇒ 모델을 구한 후 잔차의 ACF ⇒ 잔차가 정상성을 나타낸다면, 잘 만든 모델(가정을 만족함)
Q. 변수 찾는 법 : ACF, PACF
ACF - t와 t+k의 상관 관계
PACF - t와 t+k에서 그 사이에 있는 애들의 영향을 제외한 상관 관계

(2) 기존 예측 모델과 다른 점 : 비정상성 데이터 적용 가능
→ 원래 모델 : Differencing 이용 → 정상성을 가진 데이터로 바꿔서 적용
→ Differencing 자체를 고려하는 모델
(3) ARIMA 사용 여부 판단하기
⇒ Differencting 3번 이상 했음에도 Non Stationary → 다른 모델 쓰세요

ACF(자기상관함수, Auto Correlation Function)
시차에 따른 일련의 자기상관을 의마하며, 시차가 커질수록 ACF는 0에 가까워진다.
정상시계열은 상대적으로 빠르게 0에 수렴하며 비정상 시계열은 천천히 감소한다.
 
정상성 판단에 유용하다.
 
구글 주식의 200일 동안 가격, 시계열
 
정상성을 띄지 않고 ACF 그래프는 다음과 같음
 
차분하여 ACF하면 다음과 같음
차분 전 raw 신호보다 0에 빠르게 수렴함을 확인할 수 있다.


PACF(편자기상관함수, Partial Auto Correlation Function)
시차에 따른 일련의 편자기상관이며, 시차가 다른 두 시계열 데이터 간의 순수한 상호 연관성이다. T와 T-k 시점의 순수한 상관관계로서 두 시점 사이에 포함된 모든 y의 영향은 제거된다.
 
 

+) SARIMAX :
계절성까지 고려한 모델(일반적으로 날씨 데이터나 전력 등의 시계열 데이터에는 계절성이 포함되므로 이걸 쓰는 게 맞음)
⇒ ARIMA의 pdq + seasonal componet까지 고려
